//
// Autogenerated by `prisma-import`
// Any modifications will be overwritten on subsequent runs.
//

//
// main.prisma
//

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//
// auth.prisma
//

model User {
  id       Int     @id @default(autoincrement())
  email    String  @unique
  username String  @unique
  admin    Boolean @default(false)

  emailConfirmationRequest EmailConfirmationRequest?
  session                  Session[]

  userBookReadingState UserBookReadingState[]

  permissionGroupId Int
  permissionGroup   PermissionGroup @relation(fields: [permissionGroupId], references: [id])
}

model EmailConfirmationRequest {
  id         Int      @id @default(autoincrement())
  token      String   @unique
  expireDate DateTime

  user   User @relation(fields: [userId], references: [id])
  userId Int  @unique
}

model Session {
  id         Int      @id @default(autoincrement())
  token      String   @unique
  expireDate DateTime

  userId Int
  user   User @relation(fields: [userId], references: [id])
}

model Permission {
  id          Int    @id @default(autoincrement())
  name        String @unique
  description String

  permissionGroups PermissionGroup[]
}

model PermissionGroup {
  id          Int    @id @default(autoincrement())
  name        String @unique
  description String

  permissions Permission[]
  users       User[]
}

model UserBookReadingState {
  userId Int
  user   User   @relation(fields: [userId], references: [id])
  bookId BigInt
  book   Book   @relation(fields: [bookId], references: [isbn])

  state ReadingState

  @@id([userId, bookId])
}

enum ReadingState {
  READING
  READ
}

//
// book.prisma
//

model Book {
  isbn BigInt @id @unique

  title           String
  subtitle        String?
  number_of_pages Int?

  publish_date  PublishDate? @relation(fields: [publishDateId], references: [id])
  publishDateId Int?

  isbn10 BigInt? @unique
  isbn13 BigInt? @unique

  front_image Boolean @default(false)
  back_image  Boolean @default(false)

  location   Location? @relation(fields: [locationId], references: [id])
  locationId Int?

  language   Language? @relation(fields: [languageId], references: [id])
  languageId Int?

  authors              Author[]
  publishers           Publisher[]
  subjects             Subject[]
  userBookReadingState UserBookReadingState[]
}

model PublishDate {
  id    Int    @id @default(autoincrement())
  year  Int
  month Int?
  day   Int?
  Book  Book[]
}

model Location {
  id    Int    @id @default(autoincrement())
  value String @unique

  books Book[]
}

model Language {
  id    Int    @id @default(autoincrement())
  value String @unique

  books Book[]
}

model Author {
  id   Int    @id @default(autoincrement())
  name String @unique

  books Book[]
}

model Publisher {
  id   Int    @id @default(autoincrement())
  name String @unique

  books Book[]
}

model Subject {
  id    Int    @id @default(autoincrement())
  value String @unique

  books Book[]
}
